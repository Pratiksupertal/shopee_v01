
<style>
.table-center{margin-left: auto;
  margin-right: auto;}
.table-rows{border: 1px solid black;text-align: center;}
.table-cells{border: 1px solid black;text-align: center;}
.tac{text-align: center;}
.tar{text-align: right;}
.brs{border-right: hidden;}
.color{color: #d1d8dd;}
.fsize{font-size: 20px;}
.blh{border-left: hidden;}
.bbh{border-bottom: hidden; }
.f_font{font-family: Calibri, Candara, Segoe, Optima, Arial, sans-serif;}
</style>
<div class="row section-break f_font">
  <table width="100%" style="table-layout: fixed;margin-bottom:30px;" border="0px" bordercolor="#a9a9a9">
    <tr>
      <td colspan="12" class="fsize tac blh brs bbh"><b>Work Order / S P K</b></td>
    </tr>
  </table>
</div>
<div class="row section-break f_font">
  <div class="col-xs-5">
    <table width="100%" style="table-layout: fixed;">
      {% if doc.sales_order %}
      <tr>
        <td width="40%"><b>Sales Order</b> </td>
        <td width="60%">{{ doc.sales_order or '' }}</td>
      </tr>
      {% endif %}

    </table>
  </div>
  <div class="col-xs-4">
    <table width="100%" style="table-layout: fixed;">
      <tr>

      </tr>
      <tr>
        <td width="40%"><b></b> </td>
        <td width="60%"></td>
      </tr>
    </table>
  </div>
  <div class="col-xs-4">
    <table width="100%" style="table-layout: fixed;">
      <tr>
        <td colspan="5"><b> </b></td>
        <td colspan="12" ></td>
      </tr>
      <tr>
        <td colspan="6"><b></b></td>
        <td colspan="12"></td>
      </tr>
      <tr>
        <td colspan="6"><b></b></td>
        <td colspan="6">
      </td>
      </tr>
    </table>
  </div>
</div>
<div class="row section-break f_font">
  <div class="col-xs-4">
    <table width="100%" style="table-layout: fixed;">
      <tr>
        {% if doc.supplier %}
        <td width="40%"><b>No. PO</b></td>
        <td width="60%"><b>{{ doc.name or '' }}</b></td>
        {% endif %}
      </tr>

    </table>
  </div>
  <div class="col-xs-4">
    <table width="100%" style="table-layout: fixed;">
      <tr>
        {% if doc.supplier %}
        <td width="40%"><b>Nama Supplier</b> </td>
        <td width="60%">{{ doc.supplier or '' }}</td>
        {% endif %}
      </tr>
      <tr>
        <td width="40%"><b>Brand</b> </td>
        <td width="60%">{{ doc.brand or '' }}</td>
      </tr>
    </table>
  </div>
  <div class="col-xs-4">
    <table width="100%" style="table-layout: fixed;">
      <tr>
        <td colspan="5"><b>Date SPK </b></td>
        <td colspan="12" >{{ frappe.utils.formatdate(doc.get_formatted('spk_date'), "dd-MMM-yyyy") }}</td>
      </tr>
      <tr>

        <td colspan="6"><b>Finish Date</b></td>
        <!-- <td colspan="6">{{ frappe.utils.formatdate(doc.get_formatted('spk_date'), "dd-mm-yyyy") }}</td> -->
        <td colspan="12">{{ frappe.utils.formatdate(doc.get_formatted('expected_finish_date'), "dd-MMM-yyyy") }}</td>
      </tr>
      <tr>
        <td colspan="6"><b></b></td>
        <td colspan="6">
      </td>
      </tr>
    </table>
  </div>
</div>
<br>

<div class="row section-break f_font">
  <table class="table-center" width="80%" style="table-layout: fixed; border: 1px solid black;">
    <tr class="table-rows">
      <td class="table-cells">
        <b>Patron Pakai Model</b>
      </td>
      <td class="table-cells">
        {{ doc.item_model }}
      </td>
    </tr>
    <tr class="table-rows">
      <td class="table-cells">
        <b>Benang Luar</b>
      </td>
      <td class="table-cells">
        {{ doc.inner_thread }}
      </td>
    </tr>
    <tr class="table-rows">
      <td class="table-cells">
        <b>Benang Dalam</b>
      </td>
      <td class="table-cells">
        {{ doc.outer_thread }}
      </td>
    </tr>
    <tr class="table-rows">
      <td class="table-cells">
        <b>Benang Bartek</b>
      </td>
      <td class="table-cells">
        {{ doc.bartek_thread }}
      </td>
    </tr>
    {% for row in doc.instruction_table  %}
    <tr class="table-rows">
      <td class="table-cells">
        <b>{{ row.instruction_label }}</b>
      </td>
      <td class="table-cells">
        {{ row.description }}
      </td>
    </tr>
    {% endfor %}
    <tr class="table-rows">
      <td class="table-cells">
        <b>Items</b>
      </td>

      <td class="table-cells">
        <ul>
    {% for row in doc.required_item  %}
      {% if row.item_label %}
          <li>
            <b>{{ row.item_label }}</b>
          </li>
      {% endif %}
      {% if row.item_code %}
          <li>
            {{ row.item_code }}
          </li>
      {% endif %}
      {% if row.operation %}
          <li>
            <b>{{ row.operation }}</b>
          </li>
      {% endif %}
      {% if row.operation_details %}
          <li>
            {{ row.operation_details or "" }}
          </li>
      {% endif %}
    {% endfor %}
        </ul>
      </td>>
    </tr>

  </table>
</div>
<br>


<div class="row section-break f_font" style="line-height: 2;">
  <table width="100%" style="table-layout: fixed;">
    <br>
  </table>
</div>

<br>
{% set art = [] %}
{% set bom = [] %}
{% set qty1 =namespace(quantity=0) %}
{% set qty_list = [] %}
{% set material__color_material = []%}
{% set color_thread = []%}
{% set ls__ss = []%}
{% set washing = []%}
{% set art_dict = []%}
{% for row in doc.work_order_item_detail %}
  {% if row.art_no in art %}
    {% set art_dict = {"qty":"hiiii"} %}
    {% set qty1.quantity=qty1.quantity+ row.qty %}
  {% else %}
  {% set qty_list = qty_list.append(qty1.quantity) %}
    {% set qty1.quantity = row.qty %}
    {% set art = art.append(row.art_no) %}
  {% endif %}
  {% if row.bom%}  {% set bom = bom.append(row.bom) %} {%endif%}
  {% if row.color_thread%}{% set color_thread = color_thread.append(row.color_thread) %}{%endif%}
  {% if row.ls__ss %}{% set ls__ss = ls__ss.append(row.ls__ss) %}{% endif%}
  {% if row.washing %}{% set washing = washing.append(row.washing) %}{% endif %}
  {% if row.material__color_material %}{% set material__color_material = material__color_material.append(row.material__color_material) %}{% endif %}
{% endfor %}
{% set cnt=namespace(count=1) %}
<div class="" style="visibility: hidden;">
  {{qty_list.pop(0)}}
  {{ qty_list.append(qty1.quantity) }}
</div>
<!-- New table for adjustment -->
<div style="margin-top:10px;">
  <br>
  <label for="">Work Order Item</label>
  <table width= "100% " style= "overflow-x:auto; " border= "1px " bordercolor= "#d1d8dd ">

    <tr>
      <th class= "tac " width= "6% "><b>No.</b></th>
      <th class= "tac " width= "25% "><b>Art No</b></th>
      <th class= "tac " width= "10% "><b>Qty</b></th>
      <th class= "tac " width= "35% "><b>Material & Color of Material</b></th>
      <!-- <th class= "tac " width= "10% "><b>Color of Material</b></th> -->
      <th class= "tac " width= "10% "><b>Color Thread</b></th>
      <th class= "tac " width= "20% "><b>Sleeve</b></th>
      <th class= "tac " width= "15% "><b>Washing</b></th>
    </tr>

     {% for row in range(art | length) %}
     <tr>
        <td>{{cnt.count}}</td>
        <td>{{art[row]}}</td>
        <td>{{qty_list[row]}}</td>
        <td>{{material__color_material or ""}}</td>
        <td>{{color_thread or ""}}</td>
        <td>{{ls__ss or ""}}</td>
        <td>{{washing or ""}}</td>
        {% set cnt.count = cnt.count+1%}
     </tr>
     {% endfor %}
   </table>
</div>
<!-- =================================================================== -->

   <br>
   <div>
     <br>
     <label for="">Size</label>
     {% if doc.size_template =="Shirt Template" %}
     <table width= "100% " style= "overflow-x:auto; " border= "1px " bordercolor= "#d1d8dd ">
       <tr>
          <th class= "tac " width= "10% "><b>Extra Small</b></th>
          <th class= "tac " width= "10% "><b>Small</b></th>
          <th class= "tac " width= "10% "><b>Medium</b></th>
          <th class= "tac " width= "10% "><b>Large</b></th>
          <th class= "tac " width= "10% "><b>Extra Large</b></th>
          <th class= "tac " width= "10% "><b>XXL</b></th>
          <th class= "tac " width= "10% "><b>XXXL</b></th>
          <th class= "tac " width= "10% "><b>Total</b></th>
       </tr>
       {% for row in doc.shirt_template %}
       <tr>
          <td class= "tac " width= "10% ">{{row.extra_small or ""}}</td>
          <td class= "tac " width= "10% ">{{row.small or ""}}</td >
          <td class= "tac " width= "10% ">{{row.med or ""}}</td>
          <td class= "tac " width= "10% ">{{row.l or ""}}</td>
          <td class= "tac " width= "10% ">{{row.xl or ""}}</td>
          <td class= "tac " width= "10% ">{{row.xxl or ""}}</td>
          <td class= "tac " width= "10% ">{{row.xxxl or ""}}</td>
          <td class= "tac " width= "10% ">{{row.total or ""}}</td>
      </tr>
      {%endfor%}
      </table>
      {% endif %}
      {% if doc.size_template =="Pant Template" %}
     <table width= "100% " style= "overflow-x:auto; " border= "1px " bordercolor= "#d1d8dd ">
       <tr>
         <th class= "tac " width= "5% "><b>27</b></th>
         <th class= "tac " width= "5% "><b>28</b></th>
         <th class= "tac " width= "5% "><b>29</b></th>
         <th class= "tac " width= "5% "><b>30</b></th>
         <th class= "tac " width= "5% "><b>31</b></th>
         <th class= "tac " width= "5% "><b>32</b></th>
         <th class= "tac " width= "5% "><b>33</b></th>
         <th class= "tac " width= "5% "><b>34</b></th>
         <th class= "tac " width= "5% "><b>35</b></th>
         <th class= "tac " width= "5% "><b>36</b></th>
         <th class= "tac " width= "5% "><b>37</b></th>
         <th class= "tac " width= "5% "><b>38</b></th>
         <th class= "tac " width= "5% "><b>39</b></th>
         <th class= "tac " width= "5% "><b>40</b></th>
         <th class= "tac " width= "5% "><b>41</b></th>
         <th class= "tac " width= "5% "><b>42</b></th>
         <th class= "tac " width= "5% "><b>43</b></th>
         <th class= "tac " width= "5% "><b>44</b></th>
         <th class= "tac " width= "5% "><b>45</b></th>
         <th class= "tac " width= "5% "><b>46</b></th>
         <th class= "tac " width= "5% "><b>47</b></th>
         <th class= "tac " width= "5% "><b>Total</b></th>
       </tr>
       {% for row in doc.pant_template %}
       <tr>
         <td class= "tac " width= "5% ">{{row.t27 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t28 or ""}}</td >
         <td class= "tac " width= "5% ">{{row.t29 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t30 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t31 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t32 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t33 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t34 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t35 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t36 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t37 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t38 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t39 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t40 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t41 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t42 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t43 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t44 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t45 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t46 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.t47 or ""}}</td>
         <td class= "tac " width= "5% ">{{row.total or ""}}</td>
       </tr>
      {%endfor%}
        {% endif %}
      </table>
   </div>
   <br>

   <div class ="row section-break f_font" style="line-height: 2;">
     <table width="100%" style="table-layout: fixed;">
       {% if doc.packing_style %}
       <tr class="table-rows">
         <td class="table-cells">
           <b>GOSOKAN STYLE</b>
         </td>
         <td class="table-cells">
           {{ doc.packing_style }}
         </td>
       </tr>
       <br>
       {% endif %}
       {% if doc.handtag_and_sticker %}
       <tr class="table-rows">
         <td class="table-cells">
           <b>HANTAG + STICKER</b>
         </td>
         <td class="table-cells">
           {{ doc.handtag_and_sticker }}
         </td>
       </tr>
       <br>
       {% endif %}
       {% if doc.packing %}
       <tr class="table-rows">
         <td class="table-cells">
           <b>Packing</b>
         </td>
         <td class="table-cells">
           {{ doc.packing }}
         </td>
       </tr>
       {% endif %}
       {% if doc.solid_color_and_size %}
       <tr class="table-rows">
         <td class="table-cells">
           <b>WARNA/CAMPUR WARNA</b>
         </td>
         <td class="table-cells">
          {{ doc.solid_color_and_size }}
         </td>
       </tr>
       {% endif %}
       {% if doc.notes %}
       <tr class="table-rows">
         <td class="table-cells">
       <b>NOTES</b>
         </td>
         <td class="table-cells">
       {{doc.notes}}
         </td>
       </tr>
       {% endif %}
       <br>
       <br>
     </table>
   </div>

   <div class ="row section-break f_font" style="margin-top: 20px;">
     <table width="100%" style="table-layout: fixed;">
      <tr>
        <div class="col-xs-6">
          <b> <u>Created By</u></b>
        </div>
        <div class="col-xs-6" style="text-align:right">
          <b> <u>Approved By</u></b>
        </div>
       </tr>
       <tr>
         <div class="col-xs-6">
           {{doc.owner}}
           <br>
         </div>
         <div class="col-xs-6" style="text-align:right">
           {{doc.submitted_by or ""}}
         </div><br>

       </tr>
     </table>
     </div>
